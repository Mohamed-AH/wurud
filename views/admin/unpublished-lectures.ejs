<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= title %> - Duroos</title>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: #f5f5f5;
      color: #333;
    }
    .header {
      background: #1A5F5A;
      color: white;
      padding: 16px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
    }
    .header h1 { font-size: 24px; font-weight: 600; }
    .header-nav { display: flex; align-items: center; gap: 16px; }
    .header-nav a { color: white; text-decoration: none; opacity: 0.9; }
    .header-nav a:hover { opacity: 1; }
    .container { max-width: 1400px; margin: 0 auto; padding: 32px 24px; }
    .card {
      background: white;
      border-radius: 12px;
      box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
      padding: 24px;
    }
    table { width: 100%; border-collapse: collapse; margin-top: 16px; }
    thead { background: #f8f8f8; }
    th, td { padding: 12px; text-align: right; border-bottom: 1px solid #eee; }
    th { font-weight: 600; color: #666; font-size: 13px; }
    .badge {
      display: inline-block;
      padding: 4px 8px;
      border-radius: 4px;
      font-size: 12px;
      font-weight: 500;
      background: #fff3cd;
      color: #856404;
    }
    .actions { display: flex; gap: 8px; }
    .btn {
      padding: 6px 12px;
      border: none;
      border-radius: 4px;
      font-size: 13px;
      cursor: pointer;
      text-decoration: none;
      display: inline-block;
    }
    .btn-primary { background: #1A5F5A; color: white; }
    .btn-primary:hover { background: #145047; }
    .btn-success { background: #28a745; color: white; }
    .btn-success:hover { background: #218838; }
    .empty-state {
      text-align: center;
      padding: 48px;
      color: #666;
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>ğŸ“ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª ØºÙŠØ± Ø§Ù„Ù…Ù†Ø´ÙˆØ±Ø©</h1>
    <div class="header-nav">
      <a href="/admin/dashboard">Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ…</a>
      <a href="/admin/manage">Ø¥Ø¯Ø§Ø±Ø©</a>
      <a href="/auth/logout">Ø®Ø±ÙˆØ¬</a>
    </div>
  </div>

  <div class="container">
    <div class="card">
      <h2 style="margin-bottom: 16px;">Ø¥Ø¬Ù…Ø§Ù„ÙŠ: <%= lectures.length %> Ù…Ø­Ø§Ø¶Ø±Ø©</h2>

      <% if (lectures.length > 0) { %>
        <table>
          <thead>
            <tr>
              <th>Ø§Ù„Ø¹Ù†ÙˆØ§Ù† Ø¨Ø§Ù„Ø¹Ø±Ø¨ÙŠØ©</th>
              <th>Ø§Ù„Ø´ÙŠØ®</th>
              <th>Ø§Ù„Ø³Ù„Ø³Ù„Ø©</th>
              <th>Ø§Ù„Ø­Ø§Ù„Ø©</th>
              <th>Ø§Ù„Ø¥Ø¬Ø±Ø§Ø¡Ø§Øª</th>
            </tr>
          </thead>
          <tbody>
            <% lectures.forEach(lecture => { %>
              <tr>
                <td><%= lecture.titleArabic %></td>
                <td><%= lecture.sheikhId?.nameArabic || 'ØºÙŠØ± Ù…Ø­Ø¯Ø¯' %></td>
                <td><%= lecture.seriesId?.titleArabic || 'Ù…Ù†ÙØµÙ„Ø©' %></td>
                <td><span class="badge">ØºÙŠØ± Ù…Ù†Ø´ÙˆØ±Ø©</span></td>
                <td class="actions">
                  <a href="/admin/lectures/<%= lecture._id %>/edit" class="btn btn-primary">âœï¸ ØªØ¹Ø¯ÙŠÙ„</a>
                  <button class="btn btn-success" onclick="publishLecture('<%= lecture._id %>')">
                    âœ… Ù†Ø´Ø±
                  </button>
                </td>
              </tr>
            <% }) %>
          </tbody>
        </table>
      <% } else { %>
        <div class="empty-state">
          <p>âœ… Ø¬Ù…ÙŠØ¹ Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø§Øª Ù…Ù†Ø´ÙˆØ±Ø©!</p>
        </div>
      <% } %>
    </div>
  </div>

  <script>
    async function publishLecture(id) {
      try {
        const response = await fetch(`/admin/lectures/${id}/toggle-published`, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' }
        });

        const data = await response.json();

        if (data.success) {
          alert('ØªÙ… Ù†Ø´Ø± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø© Ø¨Ù†Ø¬Ø§Ø­');
          location.reload();
        } else {
          alert('ÙØ´Ù„ Ù†Ø´Ø± Ø§Ù„Ù…Ø­Ø§Ø¶Ø±Ø©');
        }
      } catch (error) {
        alert('Ø®Ø·Ø£: ' + error.message);
      }
    }
  </script>
</body>
</html>
